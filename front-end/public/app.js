function ModalService(){this.title="",this.data={},this.getTitle=function(){return this.title},this.getData=function(){return this.data},this.open=function(t,a){this.title=t,a?this.data=a:this.data={}},this.closeAll=function(){this.title="",this.data={}},this.setData=function(t){this.data=t}}function DataService(t){var a=this;a.categories=[],a.contacts=[],a.getCategories=function(){return this.categories},a.getContacts=function(){return this.contacts},a.refreshCategories=function(t){this.categories=t},a.refreshContacts=function(t){this.contacts=t},a.open=function(t,a){this.title=t,a?this.data=a:this.data={}},a.closeAll=function(){this.title="",this.data={}},a.setData=function(t){this.data=t},t.get("http://54.233.113.143:4243/",{}).success(function(t,e){a.refreshCategories(t.categories),a.refreshContacts(t.contacts)})}function ContactEditorModal(t,a){return{restrict:"A",link:function(e,o,l){e.Modal=a,e.$watch("Modal.getTitle()",function(t){"contact-editor-modal"==t?o.modal("show"):o.modal("hide")}),$(o).bind("hide.bs.modal",function(){t(function(){"contact-editor-modal"==a.getTitle()&&a.closeAll()})})}}}function ContactDeleteModal(t,a){return{restrict:"A",link:function(e,o,l){e.Modal=a,e.$watch("Modal.getTitle()",function(t){"contact-delete-modal"==t?o.modal("show"):o.modal("hide")}),$(o).bind("hide.bs.modal",function(){t(function(){"contact-delete-modal"==a.getTitle()&&a.closeAll()})})}}}function CategoryEditorModal(t,a){return{restrict:"A",link:function(e,o,l){e.Modal=a,e.$watch("Modal.getTitle()",function(t){"category-editor-modal"==t?o.modal("show"):o.modal("hide")}),$(o).bind("hide.bs.modal",function(){t(function(){"category-editor-modal"==a.getTitle()&&a.closeAll()})})}}}function CategoryDeleteModal(t,a){return{restrict:"A",link:function(e,o,l){e.Modal=a,e.$watch("Modal.getTitle()",function(t){"category-delete-modal"==t?o.modal("show"):o.modal("hide")}),$(o).bind("hide.bs.modal",function(){t(function(){"category-delete-modal"==a.getTitle()&&a.closeAll()})})}}}function ModalController(t,a,e,o){t.Data=e,t.Modal=a,t.$watch("Modal.getData()",function(a){t.data=a}),t.confirmDeleteCategory=function(){a.open("category-delete-modal",t.data)},t.deleteCategory=function(){o["delete"]("http://54.233.113.143:4243/category/"+t.data._id).success(function(t,a){e.refreshCategories(t.categories),e.refreshContacts(t.contacts)}),a.closeAll()},t.saveCategory=function(){o.post("http://54.233.113.143:4243/category",{form:t.data}).success(function(t,a){e.refreshCategories(t.categories),e.refreshContacts(t.contacts)}),a.closeAll()},t.confirmDeleteContact=function(){a.open("contact-delete-modal",t.data)},t.deleteContact=function(){o["delete"]("http://54.233.113.143:4243/contact/"+ +t.data._id).success(function(t,a){e.refreshContacts(t.contacts)}),a.closeAll()},t.saveContact=function(){console.log(t.data),o.post("http://54.233.113.143:4243/contact",{form:t.data}).success(function(t,a){e.refreshContacts(t.contacts)}),a.closeAll()},t.hasCategory=function(a){for(var e=0;e<t.data.categories.length;e++)if(t.data.categories[e]==a._id)return!0;return!1},t.toggleCategory=function(a){t.data.categories||(t.data.categories=[]);for(var e=0;e<t.data.categories.length;e++)if(t.data.categories[e]==a._id)return void t.data.categories.splice(e,1);t.data.categories.push(a._id)}}function MainController(t,a,e){t.Data=e,t.current_category=null,t.search="",t.$watch("Data.getCategories()",function(a){t.categories=a},!0),t.$watch("Data.getContacts()",function(a){t.contacts=a},!0);var o=function(t,a){for(var e=0;e<t.length;e++)if(t[e]==a)return!0;return!1};t.filteredContacts=function(){for(var a=[],e=0;e<t.contacts.length;e++){var l=t.contacts[e];(null==t.current_category||o(l.categories,t.current_category))&&(-1==l.name.indexOf(t.search)&&-1==l.email.indexOf(t.search)||a.push(l))}return a},t.selectCategory=function(a){null!=a?t.current_category=a._id:t.current_category=null},t.newCategory=function(){a.open("category-editor-modal",{})},t.editCategory=function(t){a.open("category-editor-modal",t)},t.newContact=function(){a.open("contact-editor-modal",{})},t.editContact=function(t){a.open("contact-editor-modal",t)},t.confirmDeleteContact=function(t){a.open("contact-delete-modal",t)}}DataService.$inject=["$http"],angular.module("templates",[]),angular.module("app",["templates"]),angular.module("app").service("Modal",ModalService),angular.module("app").service("Data",DataService),angular.module("app").directive("contactEditorModal",ContactEditorModal),ContactEditorModal.$inject=["$timeout","Modal"],angular.module("app").directive("contactDeleteModal",ContactDeleteModal),ContactDeleteModal.$inject=["$timeout","Modal"],angular.module("app").directive("categoryEditorModal",CategoryEditorModal),CategoryEditorModal.$inject=["$timeout","Modal"],angular.module("app").directive("categoryDeleteModal",CategoryDeleteModal),CategoryDeleteModal.$inject=["$timeout","Modal"],angular.module("app").controller("ModalController",ModalController),ModalController.$inject=["$scope","Modal","Data","$http"],angular.module("app").controller("MainController",MainController),MainController.$inject=["$scope","Modal","Data"],angular.module("templates").run(["$templateCache",function(t){t.put("modals/category-delete-modal.html",'<div class="modal fade" id="category-delete-modal" category-delete-modal><div class="modal-dialog modal-sm" ng-if="Modal.getTitle() == \'category-delete-modal\'"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title text-center">Confirmar exclusão</h4></div><div class="modal-body"><p>Você tem certeza que deseja excluir <b>{{ data.name }}</b></p></div><div class="modal-footer"><button type="button" class="btn btn-default" data-dismiss="modal">Cancelar</button> <button type="button" class="btn btn-danger" ng-click="deleteCategory()">Excluir</button></div></div></div></div>'),t.put("modals/category-editor-modal.html",'<div class="modal fade" id="category-editor-modal" category-editor-modal><div class="modal-dialog modal-sm" ng-if="Modal.getTitle() == \'category-editor-modal\'"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title text-center" ng-if="!data._id">Nova categoria</h4><h4 class="modal-title text-center" ng-if="data._id">Editar categoria</h4></div><div class="modal-body"><div class="form-group"><label>Nome da categoria</label><input type="text" class="form-control" placeholder="Nome da categoria" ng-model="data.name"></div></div><div class="modal-footer"><button type="button" class="btn btn-danger" ng-click="confirmDeleteCategory()" ng-if="data._id">Excluir</button> <button type="button" class="btn btn-default" data-dismiss="modal" ng-if="!data._id">Cancelar</button> <button type="button" class="btn btn-primary" ng-click="saveCategory()">Salvar</button></div></div></div></div>'),t.put("modals/contact-delete-modal.html",'<div class="modal fade" id="contact-delete-modal" contact-delete-modal><div class="modal-dialog modal-sm" ng-if="Modal.getTitle() == \'contact-delete-modal\'"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title text-center">Confirmar exclusão</h4></div><div class="modal-body"><p>Você tem certeza que deseja excluir <b>{{ data.name }}</b></p></div><div class="modal-footer"><button type="button" class="btn btn-default" data-dismiss="modal">Cancelar</button> <button type="button" class="btn btn-danger" ng-click="deleteContact()">Excluir</button></div></div></div></div>'),t.put("modals/contact-editor-modal.html",'<div class="modal fade" id="contact-editor-modal" contact-editor-modal><div class="modal-dialog modal-sm" ng-if="Modal.getTitle() == \'contact-editor-modal\'"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title text-center" ng-if="!data._id">Novo contato</h4><h4 class="modal-title text-center" ng-if="data._id">Editar contato</h4></div><form class="modal-body"><div class="form-group"><label>Nome completo</label><input type="text" class="form-control" placeholder="Nome completo" ng-model="data.name"></div><div class="form-group"><label>Email</label><input type="text" class="form-control" placeholder="Email" ng-model="data.email"></div><div class="form-group"><label>Telefone</label><input type="text" class="form-control" placeholder="Telefone" ng-model="data.tel"></div><div class="form-group"><label>Categorias</label><div class="categories-selection"><p ng-repeat="category in categories | orderBy: \'name\'"><input type="checkbox" ng-checked="hasCategory(category)" ng-click="toggleCategory(category)"> {{ category.name }}</p></div></div></form><div class="modal-footer"><button type="button" class="btn btn-default" data-dismiss="modal">Fechar</button> <button type="button" class="btn btn-primary" ng-click="saveContact()">Salvar</button></div></div></div></div>')}]);